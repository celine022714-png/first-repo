#DISCLAIMER# ONLY SCAN NETWORKS THAT YOU OWN OR HAVE PERMISSION TO SCAN.



import vulnerabscanner as portscanner  #Imports a custom python module named vulnerabscanner. The module contains the port scan class and scanning logic.

targets_ip = input('[+] * Enter Target To Scan For Vulnerable Open Ports: ') #Prompts the user to enter an IP address or hostname.
port_input = input('[+] * Enter Ports To Scan (comma separated, e.g., 21,22,80): ') #Prompts the user to enter ports.
vul_file = input('[+] * Enter Path To The File With Vulnerable Softwares: ') # Asks for a file path that contains known vulnerable software names.

def parse_ports(ports_input):  #Defines a function that takes the user's port input and converts it into a clean list of integers.
    ports = set()   #Creates an empty set to store ports.

    if '-' in ports_input:  # range like 1-100 #Indicates the user entered a range of ports.
        start, end = ports_input.split('-')  #Splits the range "1-100" > "1" and "100"
        ports.update(range(int(start), int(end) + 1))

    elif ',' in ports_input:  # list like 80,443,22
        ports.update(int(p.strip()) for p in ports_input.split(','))  

    else:  # single port #Runs if neither a range nor list.
        ports.add(int(ports_input.strip()))  #Removes spaces.Converts to integer. Adds a single port to the set.

    return sorted(ports)  #Converts the set into a sorted list.

ports_to_scan = parse_ports(port_input)  #Stores the cleaned ports into port_to_scan.

target = portscanner.portscan(targets_ip, ports_to_scan)  #Creates a port scanner object that passes target_Ip, the IP you want to scan and port_to_scan which ist he list of ports from earlier.
target.scan()  #Starts the actual port scan.

print("\n[DEBUG] Open ports found:", target.open_ports)  #Prints all open ports discovered.
print("[DEBUG] Banners grabbed:")  #Announces banner results.
for b in target.banners:  #Loops through each banner found during scanning.
    print("   ->", repr(b))  #Print each banner. The repr() shows raw characters which is useful for debugging.
print()   #Adds a blank line for cleaner output.

try: #Starts error handling that protects againts missing files.
    with open(vul_file,'r') as file: #Opens the vulnerability list file, read only mode.
        count = 0  #Counter for how many vulnerabilities are found.
        for banner in target.banners:  #Loops through every banner detected open ports.
            file.seek(0) #resets file pointer to the top of the file.
            for line in file.readlines(): #Reads each line in vul.txt, each line represents a known vulnerable service.
                if line.strip() in banner: #Removes spaces/newlines from file line. Checks if that vulnerable string exists inside the banner.
                     print('[!!] VULNERABLE BANNER: "' + banner + '" ON PORT: ' + str(target.open_ports[count]))  #Alerts the user that a vulnerability was found.Displays a banner name and port number where it was found.
                     count += 1 #Increments vulnerability counter.
                if count == 0:  #Checks if no vulnerability were detected.
                    print("[*] No vulnerable banners matched the list in", vul_file)  #Tells the user the scan was cleaned (based on your list).
except FileNotFoundError: #Catches error if vul.txt does not exist.
    print(f"[!] File not found: {vul_file}")
except PermissionError:
    print(f"[!] No permission to read: {vul_file}. Try moving it to C:\\Scripts.")



