#DISCLAIMER# ONLY SCAN NETWORKS THAT YOU OWN OR HAVE PERMISSION TO SCAN.



import vulnerabscanner as portscanner  #Imports a custom python module named vulnerabscanner. The module contains the port scan class and scanning logic.

targets_ip = input('[+] * Enter Target To Scan For Vulnerable Open Ports: ') #Prompts the user to enter an IP address or hostname.
port_input = input('[+] * Enter Ports To Scan (comma separated, e.g., 21,22,80): ') #Prompts the user to enter ports.
vul_file = input('[+] * Enter Path To The File With Vulnerable Softwares: ') # Asks for a file path that contains known vulnerable software names.

def parse_ports(ports_input):  #Defines a function that takes the user's port input and converts it into a clean list of integers.
    ports = set()   #Creates an empty set to store ports.

    if '-' in ports_input:  # range like 1-100 #Indicates the user entered a range of ports.
        start, end = ports_input.split('-')  #Splits the range "1-100" > "1" and "100"
        ports.update(range(int(start), int(end) + 1))

    elif ',' in ports_input:  # list like 80,443,22
        ports.update(int(p.strip()) for p in ports_input.split(','))

    else:  # single port
        ports.add(int(ports_input.strip()))

    return sorted(ports)

ports_to_scan = parse_ports(port_input)

target = portscanner.portscan(targets_ip, ports_to_scan)
target.scan()

print("\n[DEBUG] Open ports found:", target.open_ports)
print("[DEBUG] Banners grabbed:")
for b in target.banners:
    print("   ->", repr(b))
print()

try:
    with open(vul_file,'r') as file:
        count = 0
        for banner in target.banners:
            file.seek(0)
            for line in file.readlines():
                if line.strip() in banner:
                     print('[!!] VULNERABLE BANNER: "' + banner + '" ON PORT: ' + str(target.open_ports[count]))
                     count += 1
                if count == 0:
                    print("[*] No vulnerable banners matched the list in", vul_file)
except FileNotFoundError:
    print(f"[!] File not found: {vul_file}")
except PermissionError:
    print(f"[!] No permission to read: {vul_file}. Try moving it to C:\\Scripts.")


